<template>
  <section id="animation-wrap" class="py-16">
    <v-row no-gutters justify="center" align="center">
      <v-col cols="3" class="d-flex justify-center icons">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 100 100"
          filter="url(#glow)"
        >
          <path
            d="M37.1 11a3 3 0 0 0-2.7 4.6l2 3.2A17 17 0 0 0 28 33a1 1 0 0 0 1 1h42a1 1 0 0 0 1-1 17 17 0 0 0-8.4-14.2l2-3.2a3 3 0 1 0-5.1-3.1L58 16.2a26.3 26.3 0 0 0-16.2 0l-2.3-3.9A3 3 0 0 0 37 11zm0 1a2 2 0 0 1 1.6 1l2.2 3.6c-1.2.5-2.5 1-3.6 1.7l-2-3.3a2 2 0 0 1 1.8-3zm25.8 0a2 2 0 0 1 1.8 3l-2 3.3-3.6-1.7 2.2-3.6a2 2 0 0 1 1.6-1zM50 17c10.7 0 19.2 6.7 19.9 15H30c.7-8.3 9.2-15 19.9-15zm-8.5 7c-.8 0-1.4.3-1.9.8a2.7 2.7 0 0 0 0 3.4c.5.5 1.1.8 1.9.8.8 0 1.4-.3 1.9-.8a2.7 2.7 0 0 0 0-3.4c-.5-.5-1.1-.8-1.9-.8zm17 0c-.8 0-1.4.3-1.9.8a2.7 2.7 0 0 0 0 3.4c.5.5 1.1.8 1.9.8.8 0 1.4-.3 1.9-.8a2.7 2.7 0 0 0 0-3.4c-.5-.5-1.1-.8-1.9-.8zm-17 1c.5 0 .9.2 1.1.5.3.2.4.6.4 1s-.1.8-.4 1c-.2.3-.6.5-1.1.5-.5 0-.9-.2-1.1-.5-.3-.2-.4-.6-.4-1s.1-.8.4-1c.2-.3.6-.5 1.1-.5zm17 0c.5 0 .9.2 1.1.5.3.2.4.6.4 1s-.1.8-.4 1c-.2.3-.6.5-1.1.5-.5 0-.9-.2-1.1-.5-.3-.2-.4-.6-.4-1s.1-.8.4-1c.2-.3.6-.5 1.1-.5zM20 37a5 5 0 0 0-5 5v19a5 5 0 0 0 5 5 5 5 0 0 0 5-5V42a5 5 0 0 0-5-5zm9 0a1 1 0 0 0-1 1v31a6 6 0 0 0 6 6h2v9a5 5 0 0 0 5 5 5 5 0 0 0 5-5v-9h8v9a5 5 0 0 0 5 5 5 5 0 0 0 5-5v-9h2a6 6 0 0 0 6-6V38a1 1 0 0 0-1-1H29zm51 0a5 5 0 0 0-5 5v19a5 5 0 0 0 5 5 5 5 0 0 0 5-5V42a5 5 0 0 0-5-5zm-60 2a3 3 0 0 1 3 3v19a3 3 0 0 1-3 3 3 3 0 0 1-3-3V42a3 3 0 0 1 3-3zm10 0h40v30a4 4 0 0 1-4 4h-2.8a1 1 0 0 0-.4 0h-7.6a1 1 0 0 0-.2 0 1 1 0 0 0-.2 0h-9.6a1 1 0 0 0-.4 0h-7.6a1 1 0 0 0-.2 0 1 1 0 0 0-.2 0H34a4 4 0 0 1-4-4V39zm50 0a3 3 0 0 1 3 3v19a3 3 0 0 1-3 3 3 3 0 0 1-3-3V42a3 3 0 0 1 3-3zm-46.5 3a.5.5 0 0 0-.5.5v22c0 3 2.5 5.5 5.5 5.5h18a.5.5 0 1 0 0-1h-18C36 69 34 67 34 64.5v-22a.5.5 0 0 0-.5-.5zm25 27a.5.5 0 1 0 0 1h5a.5.5 0 1 0 0-1h-5zm7 0a.5.5 0 1 0 0 1h1a.5.5 0 1 0 0-1h-1zM38 75h6v9a3 3 0 0 1-3 3 3 3 0 0 1-3-3v-9zm18 0h6v9a3 3 0 0 1-3 3 3 3 0 0 1-3-3v-9z"
          />
        </svg>
      </v-col>

      <v-col cols="3" class="d-flex justify-center icons">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          xml:space="preserve"
          viewBox="0 0 52.2 52.2"
          filter="url(#glow)"
        >
          <path
            d="M36.8 1V0l-1.1.1c-.1 0-10.3 1.2-11 12.6v1.1h1.1c.1 0 11.6-1 11-12.7zm-2 1.3c-.2 6.9-5.5 8.8-8 9.3 1-6.7 5.8-8.7 8-9.3z"
          />
          <path
            d="m46.6 37.5-.7-.2a9.3 9.3 0 0 1-1.1-17.2l1-.4-.6-1c-.2-.4-2.4-3.9-7-5-3.6-1-7.7-.2-12.1 2.4-2-1.2-8.1-4.4-13.1-1.2-1 .6-11.2 6.7-5.9 23.4.2.3 3.9 9 8.3 12.3 1.2 1.2 4.2 2.6 7.7.2.6-.2 4.7-1.8 7.2 0a8 8 0 0 0 4.4 1.4 5 5 0 0 0 3.8-1.6 31 31 0 0 0 8-11.9l.2-.2-.1-1zm-9.4 11.6H37c-2.2 2.4-5.5.2-5.6.1a7.2 7.2 0 0 0-4.3-1.2c-2.6 0-4.8 1-5 1l-.1.1c-3 2.1-5.1.3-5.3 0h-.2C12.6 46 9 37.6 9 37.6c-5-15.6 4.6-20.7 5-21 4.7-3 11.4 1.4 11.5 1.5l.5.3.6-.3c4.1-2.5 7.9-3.4 11.1-2.5 2.7.6 4.3 2.3 5.2 3.3a11.2 11.2 0 0 0 1.5 20A29.6 29.6 0 0 1 37.2 49z"
          />
        </svg>
      </v-col>
      <v-col cols="3" class="d-flex justify-center icons">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 100 100"
          filter="url(#glow)"
        >
          <path
            d="M85 14a1 1 0 0 0-.1 0l-39 5.6a1 1 0 0 0-.9 1V48a1 1 0 0 0 1 1h39a1 1 0 0 0 1-1V15a1 1 0 0 0-1-1zm-1 2.2V47H47V21.4l37-5.2zm-42 4a1 1 0 0 0-.1 0l-27 3.8a1 1 0 0 0-.9 1v23a1 1 0 0 0 1 1h27a1 1 0 0 0 1-1V21.1a1 1 0 0 0-1-1zm28.5 1h-1a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1zm-3 .3-4 .6a.5.5 0 0 0 0 1l4-.6a.5.5 0 0 0 0-1zm-26.5.8V47H16V25.9l25-3.6zm19.5.2-10 1.5a.5.5 0 0 0 0 1l10-1.5a.5.5 0 0 0 0-1zm-23 3.3L21 28.2a2.5 2.5 0 0 0-2.1 2.4v12.9a.5.5 0 1 0 1 0V30.6c0-.7.5-1.3 1.3-1.4l16.3-2.4a.5.5 0 0 0 0-1zm43 6.2a.5.5 0 0 0-.5.5v11a.5.5 0 1 0 1 0v-11a.5.5 0 0 0-.5-.5zM15 51a1 1 0 0 0-1 1v23a1 1 0 0 0 .9 1l27 3.8a1 1 0 0 0 1.1-1V52a1 1 0 0 0-1-1H15zm31 0a1 1 0 0 0-1 1v27.4a1 1 0 0 0 .9 1l39 5.6a1 1 0 0 0 1.1-1V52a1 1 0 0 0-1-1H46zm-30 2h25v24.7l-25-3.6V53zm31 0h37v30.8l-37-5.2V53zm-27.5 3a.5.5 0 0 0-.5.5v12.9c0 1.2 1 2.3 2.1 2.4l16.3 2.4a.5.5 0 1 0 .2-1l-16.3-2.4c-.8 0-1.3-.7-1.3-1.4V56.5a.5.5 0 0 0-.5-.5zm61 0a.5.5 0 0 0-.5.5v21c0 1-.8 1.6-1.7 1.5l-27.7-4a.5.5 0 0 0-.2 1l27.7 4c1.5.2 2.9-1 2.9-2.5v-21a.5.5 0 0 0-.5-.5z"
          />
        </svg>
      </v-col>
    </v-row>
    <div id="animation-device">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        height="100%"
        width="100%"
        stroke-width="1"
        viewBox="0 0 300 350"
        filter="url(#glow)"
      >
        <g id="devices">
          <path fill="#2dd4bf" d="M104 122H74v-7h30v7z" class="adShape1" />
          <path stroke="none" d="M125 95H53V77h72v18z" class="adShape2" />
          <path d="M144 137.3h-27.3V114H144v23.3z" class="ad-shape-3" />
          <path stroke="none" d="M144 105.7H36V91h108v14.7z" class="adShape4" />
          <path
            stroke="none"
            d="M160.3 141.7H133V88h27.3v53.7z"
            class="adShape5"
          />
          <path
            stroke="none"
            d="M160.3 75.7H19V61h141.3v14.7z"
            class="adShape6"
          />
          <path stroke="none" d="M141 182H39V28h102v154z" class="adShape7" />
          <path stroke="none" d="M141 26H39V11h102v15z" class="adShape8" />
          <path
            d="M75 86h28a5 5 0 0 1 5 5v60a5 5 0 0 1-5 5H75a5 5 0 0 1-5-5V91a5 5 0 0 1 5-5z"
            class="phone phone1"
          />
          <path d="M72.7 94.2h32.6v53.6H72.7V94.2z" class="phone phone2" />
          <path
            d="M87.2 149.4h3.6a2 2 0 0 1 2 2v.4a2 2 0 0 1-2 2h-3.6a2 2 0 0 1-2-2v-.4c0-1 .9-2 2-2z"
            class="phone phone3"
          />
          <path
            d="M86.2 88.7h5.6c.6 0 1 .3 1 .7h0c0 .4-.5.7-1 .7h-5.6c-.6 0-1-.3-1-.7h0c0-.4.5-.7 1-.7z"
            class="phone phone4"
          />
          <path
            d="M75.7 87h0c.7 0 1.3.7 1.3 1.5h0c0 .7-.6 1.3-1.3 1.3h0c-.8 0-1.4-.6-1.4-1.3h0c0-.8.7-1.4 1.4-1.4z"
            class="phone phone5"
          />
          <path
            d="M79 87.6h0c.4 0 .8.4.8.9h0c0 .4-.4.8-.8.8h0a.8.8 0 0 1-.9-.8h0c0-.5.4-.9.9-.9z"
            class="phone phone6"
          />
          <path
            d="M51 64h75.6a5 5 0 0 1 5 5v103a5 5 0 0 1-5 5H51a5 5 0 0 1-5-5V69a5 5 0 0 1 5-5z"
            class="tablet tablet1"
          />
          <path d="M50.4 73.7h76.8v93.6H50.4V73.7z" class="tablet tablet2" />
          <path
            d="M88.6 169H90a2 2 0 0 1 2 2v1.4a2 2 0 0 1-2 2h-1.3a2 2 0 0 1-2-2V171c0-1.2 1-2 2-2z"
            class="tablet tablet3"
          />
          <path
            d="M89.4 67.5h.2c.5 0 1 .5 1 1v.2c0 .6-.5 1-1 1h-.2a1 1 0 0 1-1-1v-.2c0-.5.4-1 1-1z"
            class="tablet tablet4"
          />
          <path d="M53 65.3h0z" class="tablet tablet5" />
          <path d="M59.2 66.2h0z" class="tablet tablet6" />
          <path
            d="M20.4 75h138.7c.5 0 1 .5 1 1v94H19.4V76c0-.5.5-1 1-1z"
            class="laptop laptop1"
          />
          <path d="M23.2 78.8h133v84.9h-133V78.8z" class="laptop laptop2" />
          <path d="M89 170h0z" class="laptop laptop3" />
          <path
            d="M90 75.7h0c.6 0 1 .5 1 1h0c0 .6-.5 1-1 1h0a1 1 0 0 1-1-1h0c0-.5.5-1 1-1z"
            class="laptop laptop4"
          />
          <path
            d="M165.1 178.1h-153c-4 0-4.1-5.5-4.1-5.5h64.6l2.6 2.5H103l2.6-2.5h64.6s.4 5.5-5 5.5z"
            class="laptop laptop5"
          />
          <path
            d="M2 50h173.6a2 2 0 0 1 2 2v101.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V52c0-1.1.9-2 2-2z"
            class="desktop desktop1"
          />
          <path d="M4.2 54.2h169.3v93H4.1v-93z" class="desktop desktop2" />
          <path
            d="M90.2 50.7h0c.8 0 1.4.6 1.4 1.4h0c0 .7-.6 1.4-1.4 1.4h0c-.8 0-1.4-.7-1.4-1.4h0c0-.8.6-1.4 1.4-1.4z"
            class="desktop desktop3"
          />
          <path
            d="M109.1 178.1H66c-4.1 0 1-3.2 3.7-9.8 2.6-6.3 3-13.3 3-13.3h30.8s1 10 3.3 14.1c3.5 6.6 7.7 9 2.2 9z"
            class="desktop desktop4"
          />
          <path d="M152.9 193.8H27V0h125.9v193.8z" class="kiosk kiosk1" />
          <path d="M143.4 184.5h-107V7.7h107v176.8z" class="kiosk kiosk2" />
          <path
            d="M129 229H53l-.2-3-2.6-32H132l-2.8 33.2-.3 1.8z"
            class="kiosk kiosk3"
          />
        </g>
      </svg>
    </div>
     
      <h1 class="text-h5 text-md-h2 font-weight-black text-center typed">
        Universal Applications <span>on multiple platforms</span>
      </h1>
     
  </section>
</template>

<script>
export default {
  setup() {
    const { $gsap: gsap, $Draggable: Draggable } = useNuxtApp();

    return {
      gsap,
    };
  },

  mounted() {
    this.startAnimation();
  },
  methods: {
    startAnimation() {
      const gsap = this.gsap;

      function weightedRandom(collection, ease) {
        return gsap.utils.pipe(
          Math.random, // random number between 0 and 1
          gsap.parseEase(ease), // apply the ease
          gsap.utils.mapRange(0, 1, -0.5, collection.length - 0.5), // map to the index range of the array, stretched by 0.5 each direction because we'll round and want to keep distribution (otherwise linear distribution would be center-weighted slightly)
          gsap.utils.snap(1), // snap to the closest integer
          (i) => collection[i] // return that element from the array
        );
      }

      const colors = [
        "#02f4c8",
        "#41bbf6",
        "#2dd4bf",
        "#34d399",
        "#06b6d4",
        "#0ea5e9",
      ];
      const randomColor = weightedRandom(colors, "linear");

      const icons = document.querySelectorAll(".icons svg");
      gsap.set([icons], {
        fill: "none",
        stroke: randomColor,
      });
      gsap.set(".ad-shape-3", {
        opacity: 1,
      });
      gsap.set(".adShape1", {
        fill: randomColor,
      });
      gsap.set(
        ".phone, .tablet, .laptop, .desktop, .kiosk, .ad-shape-3, .adShape1",
        {
          stroke: randomColor,
        }
      );

      gsap
        .timeline({
          defaults: { duration: 1, ease: "expo.inOut" },
          scrollTrigger: {
            trigger: "#animation-wrap",
            start: "top top",
            end: "+=1000",
            scrub: 0.5,
            pin: "#animation-wrap",
            snap: "labels",
          },
        })
        .from(".icons path", {
          drawSVG: 0,
          strokeWidth: "0.1rem",
          duration: 4,
        })
        .to(icons, {
          fill: randomColor,
          strokeWidth: "0.05rem",
        })
        .to(".typed span", {
          duration: 4,
          text: "catering extensive audiences",
        })
        .add("tablet", 0.1)
        .to(".phone", { morphSVG: (i) => ".tablet" + (i + 1) }, "tablet")
        .to(".phone5, .phone6", { opacity: 0, morphSVG: ".tablet5" }, "tablet")
        .to(".adShape1", { morphSVG: ".adShape2" }, "tablet")

        .add("laptop", 1.5)
        .to(".phone", { morphSVG: (i) => ".laptop" + (i + 1) }, "laptop")
        .to(".phone3", { opacity: 0, y: -4 }, "laptop")
        .fromTo(
          ".laptop5",
          { scale: 0, transformOrigin: "50% 50%" },
          { scale: 1, opacity: 1 },
          "laptop"
        )
        .to(".adShape1", { morphSVG: ".adShape4" }, "laptop")
        .from(".ad-shape-3", { scale: 0, opacity: 0 }, "laptop")

        .add("desktop", 3)
        .to(".phone1", { morphSVG: ".desktop1" }, "desktop")
        .to(".phone2", { morphSVG: ".desktop2" }, "desktop")
        .to(".phone4", { morphSVG: ".desktop3" }, "desktop")
        .to(
          ".laptop5",
          { morphSVG: { shape: ".desktop4", shapeIndex: 0 }, y: 0.5 },
          "desktop"
        )
        .to(".adShape1", { morphSVG: ".adShape6" }, "desktop")
        .to(".ad-shape-3", { morphSVG: ".adShape5" }, "desktop")

        .add("kiosk", 4.5)
        .to(".phone1", { morphSVG: ".kiosk1" }, "kiosk")
        .to(".phone2", { morphSVG: ".kiosk2" }, "kiosk")
        .to(".phone4", { scale: 0, y: -48 }, "kiosk")
        .to(".laptop5", { morphSVG: ".kiosk3", y: 0 }, "kiosk")
        .to(".adShape1", { morphSVG: ".adShape8" }, "kiosk")
        .to(
          ".ad-shape-3",
          { morphSVG: ".adShape7", ease: "back.inOut(0.6)" },
          "kiosk"
        )
        .add("end");
    },
  },
};
</script>

<style>
#animation-device {
  position: relative;
  width: 100%;
  height: 70vh;
  fill: none;
  stroke: var(--v-accent-base);
}

#devices {
  transform: translateX(60px) translateY(40px);
}

.ad-shape-3,
.tablet,
.laptop,
.desktop,
.kiosk {
  opacity: 0;
}

.icons {
  height: 10vh;
  fill: var(--v-primary-base);
  stroke: var(--v-accent-base);
}
</style>
